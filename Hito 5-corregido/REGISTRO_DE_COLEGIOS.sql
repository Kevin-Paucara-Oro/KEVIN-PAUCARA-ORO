CREATE  DATABASE REGISTRO_DE_COLEGIOS;
USE REGISTRO_DE_COLEGIOS;

CREATE TABLE COLEGIO
(
ID_COLEGIO    INT PRIMARY KEY NOT NULL,
NOMBRE        VARCHAR(50)NOT NULL,
DIRECCION     VARCHAR (100)NOT NULL,
TIPO          VARCHAR(50)NOT NULL,
TURNO         VARCHAR(100)NOT NULL,
);

INSERT INTO COLEGIO(ID_COLEGIO,NOMBRE,DIRECCION,TIPO,TURNO)
VALUES(1,'KOLPING','ZONA SANTIAGO II','PRIVADO','MAÑANA'),
      (2,'PUERTO DEL ROSARIO','HORIZONTES','FISCAL','MAÑANA'),
      (3,'RAFAEL PABON','PRIMERO DE MAYO','PRIVADO','TARDE'),
      (4,'JESUS OBRERO','SAN LUIS','FISCAL','TARDE'),
      (5,'BOLIVIA','SANTA ROSA','CONVENIO','NOCHE'),
      (6,'ANTOFAGASTA','KENKO','CONVENIO','NOCHE'),
      (7,'COPLAN','6 DE MARZO','PRIVADO','MAÑANA');

CREATE TABLE DIRECTOR
(
RDA           INT PRIMARY KEY NOT NULL,
NOMBRE        VARCHAR(50)NOT NULL,
APELLIDO      VARCHAR(100)NOT NULL,
CARGA_HORARIA INT NOT NULL,
SALARIO       INT NOT NULL,
ID_COLEGIO    INT,
FOREIGN KEY (ID_COLEGIO) REFERENCES COLEGIO (ID_COLEGIO),
);

 INSERT INTO DIRECTOR(RDA,NOMBRE,APELLIDO,CARGA_HORARIA,SALARIO,ID_COLEGIO)
 VALUES(01,'JOSE','SUAREZ',80,3200,1),
       (02,'LUISA','COLQUE',80,2200,2),
       (03,'LIMBER','SOLIZ',80,3200,3),
       (04,'LIZ','CALLE',80,2200,4),
       (05,'MARIBEL','SORIA',80,2500,5),
       (06,'LUIS','CHUQUIMIA',80,2500,6),
       (07,'PEPE','SETCH',80,2500,7);

CREATE TABLE SECRETARIA
(
RDA_S        INT PRIMARY KEY NOT NULL,
NOMBRE       VARCHAR(50)NOT NULL,
APELLIDO     VARCHAR(100)NOT NULL,
CARGA_HORARIA INT NOT NULL,
SALARIO       INT NOT NULL,
ID_COLEGIO    INT,
FOREIGN KEY (ID_COLEGIO) REFERENCES COLEGIO (ID_COLEGIO),
);

 INSERT INTO SECRETARIA(RDA_S,NOMBRE,APELLIDO,CARGA_HORARIA,SALARIO,ID_COLEGIO)
 VALUES(001,'LISBETH','TICONA',80,2200,1),
       (002,'AIME','COLQUE',80,1200,2),
       (003,'NAYELI','PATANA',80,2200,3),
       (004,'LIZETH','HUAYLLANI',80,1200,4),
       (005,'MARISABE','SOLIZ',80,1500,5),
       (006,'GABRIELA','GUEVARA',80,1500,6),
       (007,'COLT','TARA',80,1500,7);

CREATE TABLE ESTUDIANTES 
(
RUDE            INT PRIMARY KEY NOT NULL,
NOMBRE          VARCHAR (50) NOT NULL,
APELLIDO        VARCHAR(50)NOT NULL,
NIVEL           VARCHAR(100)NOT NULL,
ID_COLEGIO      INT,
FOREIGN KEY (ID_COLEGIO)REFERENCES COLEGIO(ID_COLEGIO),
);

INSERT INTO ESTUDIANTES(RUDE,NOMBRE,APELLIDO,NIVEL,ID_COLEGIO)
 VALUES(1,'LIMBER','APULACA','PRIMARIO',1),
       (2,'AIDE','QUISPE','PRIMARIO',2),
       (3,'NADIR','CACHI','SECUNDARIO',3),
       (4,'LUPE','YAMPA','PRIMARIA',4),
       (5,'MARCOS','CALLE','SECUNDARIO',5),
       (6,'LUCERO','GUEVARA','SECUNDARIO',6),
       (7,'SOFIA','GRACE','SECUNDARIO',7);

CREATE TABLE PROFESOR 
(
RDA_P               INT PRIMARY KEY NOT NULL,
NOMBRE              VARCHAR(100)NOT NULL,
APELLIDO            VARCHAR(50)NOT NULL,
CARGA_HORARIA       INT NOT NULL,
SALARIO             INT NOT NULL,
ID_COLEGIO          INT,
FOREIGN KEY (ID_COLEGIO) REFERENCES COLEGIO (ID_COLEGIO),
);

 INSERT INTO PROFESOR(RDA_P,NOMBRE,APELLIDO,CARGA_HORARIA,SALARIO,ID_COLEGIO)
 VALUES(010,'LUIS','TICONA',80,2200,1),
       (020,'AUTRIA','CHOQUE',80,1200,2),
       (030,'WILMER','VENTURA',80,2200,3),
       (040,'OLIVER','AQUIRRE',80,1200,4),
       (050,'ERIKA','PRIETO',80,1500,5),
       (060,'GALA','GUTIERREZ',80,1500,6),
       (070,'FULANO','PEREZ',80,1500,7);


CREATE TABLE MATERIA
(
ID_MATERIA       INT PRIMARY KEY NOT NULL,
NOMBRE           VARCHAR(100)NOT NULL,
PARALELO         VARCHAR(100)NOT NULL,
RUDE             INT,
RDA_P            INT,
FOREIGN KEY (RUDE)REFERENCES ESTUDIANTES(RUDE),
FOREIGN KEY (RDA_P)REFERENCES PROFESOR(RDA_P)
);

 INSERT INTO MATERIA(ID_MATERIA,NOMBRE,PARALELO,RUDE,RDA_P)
 VALUES(1,'LENGUAJE','A',1,010),
       (2,'MATEMATICAS','C',2,020),
       (3,'FISICA','B',3,030),
       (4,'CIENCIAS SOCIALES','B',4,040),
       (5,'QUIMICA','A',5,050),
       (6,'MATEMATICA','C',6,060),
	   (7,'MATEMATICA','C',7,070);

CREATE TABLE CURSO
(
ID_CURSO          INT PRIMARY KEY NOT NULL,
PARALELO          VARCHAR(50)NOT NULL,
RUDE              INT NOT NULL,
ID_COLEGIO        INT NOT NULL,
FOREIGN KEY (RUDE)REFERENCES ESTUDIANTES(RUDE),
FOREIGN KEY (ID_COLEGIO)REFERENCES COLEGIO(ID_COLEGIO)
);

 INSERT INTO CURSO(ID_CURSO,PARALELO,ID_COLEGIO, RUDE)
 VALUES(1001,'A',1,1),
       (2002,'B',2,2),
       (3003,'C',3,3),
       (4004,'D',4,4),
       (5005,'A',5,5),
       (6006,'B',6,6),
	   (6007,'B',6,7);

CREATE TABLE KARDEX
(
ID_KARDEX  INT PRIMARY KEY NOT NULL,
ID_MATERIA INT,
ID_CURSO   INT,
RUDE       INT,
NOTA       INT NOT NULL,
NOTA_ESCRITA VARCHAR (100) NOT NULL,
ID_COLEGIO INT,
FOREIGN KEY (RUDE)REFERENCES ESTUDIANTES(RUDE),
FOREIGN KEY (ID_COLEGIO)REFERENCES COLEGIO(ID_COLEGIO),
FOREIGN KEY (ID_MATERIA) REFERENCES MATERIA (ID_MATERIA),
FOREIGN KEY (ID_CURSO) REFERENCES CURSO (ID_CURSO)
);


 INSERT INTO KARDEX (ID_KARDEX,ID_MATERIA,ID_CURSO,RUDE,NOTA,NOTA_ESCRITA,ID_COLEGIO)
 VALUES (1,1,1001,1,50,'CINCUENTA',1),
        (2,2,2002,2,51,'CINCUENTA Y UNO',2),
        (3,3,3003,3,50,'CINCUENTA',3),
        (4,4,4004,4,51,'CINCUENTA Y UNO',4),
        (5,5,5005,5,60,'SECENTA',5),
        (6,6,6006,6,75,'SETENTA Y CINCO',6),
		(7,7,6007,7,100,'CIEN',7);

CREATE TABLE ASISTENCIA_ESTUDIANTES
(
  ID_ASISTENCIA INT PRIMARY KEY NOT NULL,
  FECHA         DATE NOT NULL,
  ASISTENCIA    VARCHAR(10) NOT NULL,
  RUDE          INT NOT NULL,
  ID_CURSO      INT,
  FOREIGN KEY (RUDE) REFERENCES ESTUDIANTES(RUDE),
  FOREIGN KEY (ID_CURSO) REFERENCES CURSO(ID_CURSO),
);

INSERT INTO ASISTENCIA_ESTUDIANTES(ID_ASISTENCIA,FECHA,ASISTENCIA,RUDE,ID_CURSO)
VALUES(101,'2023-09-18','RETRASO',1,1001),
      (102,'2023-11-18','RETRASO',2,2002),
      (103,'2023-01-22','RETRASO',3,3003),
      (104,'2023-08-15','RETRASO',4,4004),
      (105,'2023-03-25','RETRASO',5,5005),
      (106,'2023-09-30','RETRASO',6,6006),
      (107,'2023-12-09','RETRASO',7,6007);

CREATE TABLE ASISTENCIA_DIRECTOR
(
  ID_ASISTENCIA    INT PRIMARY KEY NOT NULL,
  FECHA            DATE NOT NULL,
  ASISTENCIA       VARCHAR(10) NOT NULL,
  RDA              INT,
  FOREIGN KEY (RDA) REFERENCES DIRECTOR(RDA),
);

INSERT INTO ASISTENCIA_DIRECTOR(ID_ASISTENCIA,FECHA,ASISTENCIA,RDA)
VALUES(111,'2023-06-30','PRESENTE',01),
      (222,'2023-09-30','PRESENTE',02),
      (333,'2023-10-30','PRESENTE',03),
      (444,'2023-11-30','PRESENTE',04),
      (555,'2023-11-30','PRESENTE',05),
      (667,'2023-12-30','PRESENTE',06),
      (777,'2023-08-30','PRESENTE',07);


CREATE TABLE ASISTENCIA_SECRETARIA
(
  ID_ASISTENCIA    INT PRIMARY KEY NOT NULL,
  FECHA            DATE NOT NULL,
  ASISTENCIA       VARCHAR(10) NOT NULL,
  RDA_S            INT,
  FOREIGN KEY ( RDA_S) REFERENCES SECRETARIA( RDA_S),
);


INSERT INTO ASISTENCIA_SECRETARIA(ID_ASISTENCIA,FECHA,ASISTENCIA,RDA_S)
VALUES(1111,'2024-06-28','PRESENTE',001),
      (2222,'2024-11-30','PRESENTE',002),
      (3333,'2024-02-29','PRESENTE',003),
      (4444,'2024-11-23','PRESENTE',004),
      (5555,'2024-09-11','PRESENTE',005),
      (6677,'2024-05-14','PRESENTE',006),
      (7777,'2024-01-01','PRESENTE',007);


CREATE TABLE ASISTENCIA_PROFESORES (
  ID_ASISTENCIA   INT PRIMARY KEY NOT NULL,
  FECHA           DATE NOT NULL,
  ASISTENCIA      VARCHAR(10) NOT NULL,
  RDA_P           INT NOT NULL,
  ID_COLEGIO      INT,
  FOREIGN KEY (RDA_P) REFERENCES PROFESOR(RDA_P),
  FOREIGN KEY (ID_COLEGIO) REFERENCES COLEGIO(ID_COLEGIO),
);

INSERT INTO ASISTENCIA_PROFESORES(ID_ASISTENCIA,FECHA,ASISTENCIA,RDA_P,ID_COLEGIO)
VALUES(11,'2023-09-18','PRESENTE',010,1),
      (22,'2023-08-18','PRESENTE',020,2),
      (33,'2023-07-20','RETRASO',030,3),
      (44,'2023-06-24','PRESENTE',040,4),
      (55,'2023-06-30','RETRASO',050,5),
      (66,'2023-12-31','PRESENTE',060,6),
      (77,'2023-01-12','PRESENTE',070,7);




SELECT *FROM COLEGIO;
SELECT *FROM DIRECTOR;
SELECT *FROM SECRETARIA;
SELECT *FROM ESTUDIANTES;
SELECT *FROM PROFESOR;
SELECT *FROM CURSO;
SELECT *FROM MATERIA;
SELECT *FROM KARDEX;
SELECT *FROM ASISTENCIA_ESTUDIANTES;
SELECT *FROM ASISTENCIA_PROFESORES;
SELECT *FROM ASISTENCIA_DIRECTOR;
SELECT *FROM ASISTENCIA_SECRETARIA;

SELECT COUNT (ASISTENCIA) AS ASITENCIA_DIRECTORES
FROM ASISTENCIA_DIRECTOR

SELECT COUNT (ASISTENCIA) AS ASITENCIA_SECRETARIA
FROM ASISTENCIA_SECRETARIA

SELECT SUM (SALARIO) AS PAGO_TOTAL_SECRETARIA
FROM SECRETARIA

SELECT AVG(NOTA) AS PROMEDIO_NOTA_ESTUDIANTES
FROM KARDEX

SELECT MAX(NOTA) AS MAXIMA_NOTA_ESTUDIANTES
FROM KARDEX

SELECT MIN(SALARIO) AS MIN_SALARIO_PROFESOR
FROM PROFESOR

SELECT MAX (SALARIO) AS MIN_SALARIO_SECRETARIA
FROM SECRETARIA

 SELECT E.NOMBRE 
 FROM ESTUDIANTES AS E


SELECT C.NOMBRE,E.NOMBRE,K.NOTA,M.NOMBRE
FROM KARDEX AS K
INNER JOIN ESTUDIANTES AS E ON E.RUDE=K.RUDE
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.ID_MATERIA= K.ID_MATERIA

SELECT P.NOMBRE,M.ID_MATERIA,P.CARGA_HORARIA, C.NOMBRE,E.NOMBRE
FROM KARDEX AS K
INNER JOIN ESTUDIANTES AS E ON E.RUDE=K.RUDE
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.ID_MATERIA= K.ID_MATERIA
INNER JOIN PROFESOR AS P ON P.RDA_P=M.RDA_P

SELECT C.NOMBRE,P.NOMBRE,P.CARGA_HORARIA,AP.ASISTENCIA
FROM KARDEX AS K
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN PROFESOR AS P ON P.ID_COLEGIO=C.ID_COLEGIO
INNER JOIN ASISTENCIA_PROFESORES AS AP ON AP.RDA_P=P.RDA_P

SELECT C.NOMBRE,C.TURNO,E.NOMBRE,NOTA_ESCRITA,M.NOMBRE,CU.PARALELO
FROM KARDEX AS K
INNER JOIN ESTUDIANTES AS E ON E.RUDE=K.RUDE
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.ID_MATERIA= K.ID_MATERIA
INNER JOIN CURSO AS CU ON CU.ID_CURSO=K.ID_CURSO

SELECT C.NOMBRE,C.DIRECCION,K.RUDE,E.NOMBRE,CU.PARALELO
FROM KARDEX AS K
INNER JOIN ESTUDIANTES AS E ON E.RUDE=K.RUDE
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.ID_MATERIA= K.ID_MATERIA
INNER JOIN CURSO AS CU ON CU.ID_CURSO=K.ID_CURSO


SELECT C.TURNO,E.APELLIDO,K.NOTA_ESCRITA,CU.PARALELO,M.NOMBRE,P.NOMBRE
FROM KARDEX AS K
INNER JOIN ESTUDIANTES AS E ON E.RUDE=K.RUDE
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.ID_MATERIA= K.ID_MATERIA
INNER JOIN CURSO AS CU ON CU.ID_CURSO=K.ID_CURSO
INNER JOIN PROFESOR AS P ON P.RDA_P=M.RDA_P

SELECT C.NOMBRE,C.DIRECCION,D.NOMBRE,S.NOMBRE,P.NOMBRE,M.NOMBRE
FROM KARDEX AS K
INNER JOIN COLEGIO AS C ON C.ID_COLEGIO = K.ID_COLEGIO
INNER JOIN SECRETARIA AS S ON S.ID_COLEGIO=C.ID_COLEGIO
INNER JOIN DIRECTOR AS D ON D.ID_COLEGIO=C.ID_COLEGIO
INNER JOIN PROFESOR AS P ON P.ID_COLEGIO=C.ID_COLEGIO
INNER JOIN MATERIA AS M ON M.RDA_P=P.RDA_P